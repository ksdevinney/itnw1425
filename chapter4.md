# Network Protocols and Routing

Headers and trailers through the layers:
* 7, 6, 5: Payload (data and instructions) generated by an application on the source host (ex the browser)
* 4: transport layer protocol adds a header to the payload, including a port number for the receiving host, whole thing becomes a segment (TCP) or datagram (UDP)
* 3: network layer adds a header to identify the IP address of the destination (whole thing is a packet)
* 2: packet is passed to the data link layer on the NIC, which adds a header and trailer, including a phyical address for finding the node on the network (whole thing is a frame)
* 1: physical layer, NIC receives the frame and places the transmission on the network

Receiving host then goes through this process in reverse order and presents the payload to the receving application

## Network Protocols

### Transmission Control Protocol

*transport layer*

TCP operates on the transport layer and provides reliable data delivery services

Header has 10 fields

TCP characteristics:
* connection-oriented: ensures a connection is established before transmitting data
* sequencing and checksums: TCP sends a test string (checksum) and destination host generates a similar string; checksums must match or the destination host asks source to retransmit the data
* flow control: gauging the appropriate rate of transmission based on how quickly the recipient can receive data

Three-way handshake: establishes a session before TCP transmits actual data
1. SYN: request for a connection; host sends a checksum, SYN flag is activated
2. SYN/ACK: response to the request; ACK and SYN flags activated, ACK sends a number equal to the checksum + 1, recipient sends its own random number
3. ACK: connection established; host issues a segment with the number recipient expects to receive, acknowledgement field set to number recipient sent + 1, ACK flag activated

Payload is sent after this process; can be done in one or more messages, depending on data size
Sequence numbers will increase by amount of bits included in each received segment

Two hosts communicate until original host activated FIN flag

### User Datagram Protocol

*transport layer*

Unreliable (doesn't guarantee delivery of data) and connectionless

More efficient and faster than TCP because it does not establish a connection; useful for live audio and video transmissions, and when speed is more important than accuracy

Header has 4 fields

## Internet Protocol

*network layer* 

Specifies where data should be delivered

Does not create a session to deliver its packets, packets travel separately and may take different routes. Once messages are delivered, TCP is responsible for putting messages back in the correct order, TCP/UDP also responsible for making sure data reaches the correct application

IPv4 is standard, but IPv6 is more secure; many organizations have not upgraded to IPv6 because of structural upgrades required

IPv4 and IPv6 have different header arrangements; both begin with a version
IPv6 packets accommodate larger IP addresses, no fragment offset fields; IPv6 adjusts packet sizes to fit the network

### Internet Control Message Panel

*network layer*

Reports on the success or failure of a delivery; announces transmission failures to the sender but does not attempt to correct errors

ICMP messages contain an ICMP header and an IP header: ICMP header contains type, code, checksum, rest of header

### Address Resolution Protocol

*data link layer*

Works with IPv4 to discover the MAC address of a node on the network, maintains a database connecting local IP addresses to MAC addresses

Relies on broadcasting, which transmits to all nodes on a network

ARP table: database of IP-to-MAC mapping
Entries can be static or dynamic: static (has been entered manually), dynamic (created when a client makes a request for data not already in the table)

### Ethernet

*data link layer*

Most popular network technology used on modern LANs

Adds both a header and a trailer to the payload it inherits from the layer above
Preamble and SFD are removed from incoming transmissions befre it becomes visible

MTU: maximum transmission unit, largest size (in bytes) routers in a network's path will allow at the network layer
Default for Ethernet is 1500 bytes

Maximum size of an IP packet is larger than Ethernet MTU- large packets are divided into smaller packets via fragmentation

## Routers

